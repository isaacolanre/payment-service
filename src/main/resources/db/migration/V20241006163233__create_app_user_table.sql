CREATE SCHEMA IF NOT EXISTS billpayment;

CREATE TABLE IF NOT EXISTS users
(
    id                        BIGSERIAL PRIMARY KEY,
    public_id                 UUID DEFAULT gen_random_uuid(),
    first_name                VARCHAR(64) NOT NULL,
    last_name                 VARCHAR(64) NOT NULL,
    username                  VARCHAR(64) NOT NULL,
    date_of_birth             DATE,
    gender                    VARCHAR(32),
    bvn                       VARCHAR(15),
    login_tries               INT              DEFAULT 0,
    pin_input_attempts        INT              DEFAULT 0,
    nickname                  VARCHAR(64) UNIQUE,
    password                  TEXT,
    pin                       TEXT,
    pin_created_at            TIMESTAMPTZ,
    email                     VARCHAR(64),
    mobile                    VARCHAR(16),
    registered_by             UUID,
    registered_by_name        TEXT,
    namespace                 VARCHAR(64) NOT NULL,
    address                   TEXT,
    lga                       TEXT,
    state                     TEXT,
    zip_code                  TEXT,
    primary_account_public_id UUID,
    account_validated         BOOLEAN          DEFAULT FALSE,
    kyc_level                 VARCHAR(64)      DEFAULT 'TIER_ZERO',
    created_at                TIMESTAMPTZ      DEFAULT now(),
    updated_at                TIMESTAMPTZ      DEFAULT now(),
    activated_at              TIMESTAMPTZ,
    blocked_at                TIMESTAMPTZ,
    blocked_until             TIMESTAMPTZ,
    referral_code             TEXT,
    referred_by               UUID,
    status                    VARCHAR(64)      DEFAULT 'ENABLED',
    credential_expired        BOOLEAN          DEFAULT FALSE,
    ussd_pin                  TEXT,
    ussd_pin_created_at       TIMESTAMPTZ,
    email_validated           BOOLEAN          DEFAULT FALSE
);
